(function(e){function t(t){for(var a,r,i=t[0],c=t[1],l=t[2],d=0,u=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&u.push(o[r][0]),o[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);m&&m(t);while(u.length)u.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==o[i]&&(a=!1)}a&&(s.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},o={app:0},s=[];function i(e){return c.p+"js/"+({"home~three":"home~three",home:"home",three:"three"}[e]||e)+"."+{"home~three":"e2ac75e5",home:"ece6fcf8",three:"0a67f8b7"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={home:1,three:1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({"home~three":"home~three",home:"home",three:"three"}[e]||e)+"."+{"home~three":"31d6cfe0",home:"95e1f90c",three:"08526f0c"}[e]+".css",o=c.p+a,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var l=s[i],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===a||d===o))return t()}var u=document.getElementsByTagName("style");for(i=0;i<u.length;i++){l=u[i],d=l.getAttribute("data-href");if(d===a||d===o)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var a=t&&t.target&&t.target.src||o,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete r[e],m.parentNode.removeChild(m),n(s)},m.href=o;var h=document.getElementsByTagName("head")[0];h.appendChild(m)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var s=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=s);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(e);var u=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(m);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",u.name="ChunkLoadError",u.type=a,u.request=r,n[1](u)}o[e]=void 0}};var m=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/dxlab-fellowship-2019/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var m=d;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),r=n.n(a);r.a},"9c0c":function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],s=(n("5c0b"),n("2877")),i={},c=Object(s["a"])(i,r,o,!1,null,null,null),l=c.exports,d=n("8c4f");a["a"].use(d["a"]);const u=[{path:"/gen/ids",name:"Ids",meta:{title:"Generate ID Lists"},component:()=>Promise.all([n.e("home~three"),n.e("home")]).then(n.bind(null,"d4eb"))},{path:"/test",name:"Test",meta:{title:"Test"},component:()=>Promise.all([n.e("home~three"),n.e("home")]).then(n.bind(null,"78c1"))},{path:"/",name:"Viewer",meta:{title:"Birdâ€™s Eye",metaTags:[{name:"description",content:"The about page of our example app."},{property:"viewport",content:"width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"}]},component:()=>Promise.all([n.e("home~three"),n.e("three")]).then(n.bind(null,"e1b1"))}],m=new d["a"]({mode:"history",base:"/dxlab-fellowship-2019/",routes:u});m.beforeEach((e,t,n)=>{const a=e.matched.slice().reverse().find(e=>e.meta&&e.meta.title),r=e.matched.slice().reverse().find(e=>e.meta&&e.meta.metaTags);if(a&&(document.title=a.meta.title),Array.from(document.querySelectorAll("[data-vue-router-controlled]")).map(e=>e.parentNode?e.parentNode.removeChild(e):null),!r)return n();r.meta.metaTags.map(e=>{const t=document.createElement("meta");return Object.keys(e).forEach(n=>{t.setAttribute(n,e[n])}),t.setAttribute("data-vue-router-controlled",""),t}).forEach(e=>document.head.appendChild(e)),n()});var h=m,p=n("9ab4"),f=n("2f62"),g=n("955d"),b=n.n(g),y=n("4d7c"),v=n.n(y),w=n("5a89");function O(){const e=w["d"];e.enabled=!0;const t=new w["G"],n=new w["h"];function a(a,r,o,s){const i=e.get(a);function c(){t.load(a,r,()=>{},s)}function l(t){const n=URL.createObjectURL(t),r=document.createElementNS("http://www.w3.org/1999/xhtml","img");r.onload=()=>{e.add(a,r),URL.revokeObjectURL(n),document.body.removeChild(r),c()},r.src=n,r.style.visibility="hidden",document.body.appendChild(r)}if(i)return i;n.load(a,l,o,s)}return n.setResponseType("blob"),Object.assign({},t,{load:a})}var j=O;const k=n("bc3a").default;a["a"].use(f["a"]);const _=4096,x=2e4,A=k.create({timeout:6e5}),B={pictures:{id:"J19GWyDjZ8Ny7",name:"pictures"},prints:{id:"vpkdDA18BDOdR",name:"prints"},drawings:{id:"GP85pXKPWzzB",name:"drawings"},paintings:{id:"0GB866Xe6mz1q",name:"paintings"},posters:{id:"b10aqZK7gRzJy",name:"posters"},medals:{id:"X8gBJlg9E1WqK",name:"medals"},photographs:{id:"wKK2B5BO3aEYa",name:"photographs",esQuery:{type:"must_not",matchType:"match_phrase_prefix",field:"item_id_callnumber_key",values:["SLIDES","ON"]}},negatives:{id:"wKK2B5BO3aEYa",name:"negatives",esQuery:{type:"should",matchType:"match_phrase_prefix",field:"item_id_callnumber_key",values:["SLIDES","ON"]}},archTechDrawings:{id:"m6zK940qx9v7K",name:"architectural drawings"},maps:{id:"40XObXd7aA4a",name:"published maps"},manuscriptMaps:{id:"Xp1qba0O2k32v",name:"unpublished maps"},objects:{id:"7MZAw5gxmyyaW",name:"objects"},stamps:{id:"BRg6jXK4mz4wG",name:"stamps"},ephemera:{id:"vz2D0Am8wvrlb",name:"ephemera"},coin:{id:"76pM49Z2jxBzR",name:"coins"},journals:{name:"journals",id:"Z5AB0OkPYjPb9"},manuscripts:{name:"manuscripts",id:"330MWgKgY5adZ"},manuscriptNotatedMusic:{name:"notated music",id:"oWWJDK5PO44me"},video:{name:"video",id:"NWOD2N4edDPzO"}},E=()=>{let e=b()();return Object.entries(B).forEach(([t,n])=>{e=e.orFilter("term","medals"!==t&&"stamps"!==t&&"coin"!==t?"format_id.keyword":"subject_curated_title","medals"!==t&&"stamps"!==t&&"coin"!==t?n.id:t)}),e},P=(e,t)=>Object(p["a"])(void 0,void 0,void 0,(function*(){for(let n=0;n<e.length;n++)yield t(e[n],n,e)})),T=({query:e,esQuery:t})=>e.filter("bool",e=>(t.values.forEach(n=>{e="must_not"===t.type?e.notFilter(t.matchType,t.field,n):e.orFilter(t.matchType,t.field,n)}),e)),L=({key:e,id:t,query:n})=>{const a="medals"!==e&&"stamps"!==e&&"coin"!==e?"format_id.keyword":"subject_curated_title",r="medals"!==e&&"stamps"!==e&&"coin"!==e?t:e;return n.filter("term",a,r)},S=e=>new Promise((t,n)=>{const a=new Image;a.addEventListener("load",()=>t(a)),a.addEventListener("error",n),a.src=e}),C=e=>Object(p["a"])(void 0,void 0,void 0,(function*(){const t="/pixels/"+e.key+".png",n=yield S(t),a=document.createElement("canvas");return a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0,n.width,n.height),{pixels:a,width:n.width}})),N=e=>{const t=e.width,n=e.height,a=t*n,r=e.getContext("2d").getImageData(0,0,t,n),o=new Float32Array(t*n*3),s=new Float32Array(t*n*3),i=new Float32Array(t*n*3),c=new w["e"];for(let l=0,d=0,u=a;l<u;l++,d+=4){c.setRGB(r.data[d]/255,r.data[d+1]/255,r.data[d+2]/255),c.convertSRGBToLinear();const e={h:0,s:0,l:0};c.getHSL(e);const n=l%t,a=Math.floor(l/t),u=0;o[3*l]=n,o[3*l+1]=a,o[3*l+2]=u,s[3*l]=c.r,s[3*l+1]=c.g,s[3*l+2]=c.b,i[3*l]=e.h,i[3*l+1]=e.s,i[3*l+2]=e.l}return{colors:s,positions:o,hsls:i}},D=({hsls:e,width:t})=>{const n=e.length/3,a=[];for(let s=0,i=0;s<n;s++,i+=3)a.push({h:e[i],s:e[i+1],l:e[i+2],i:s});a.sort((e,t)=>t.h-e.h);const r=a.map(e=>e.i),o=new Float32Array(e.length);return r.forEach((e,n)=>{const a=n%t,r=Math.floor(n/t),s=0;o[3*e]=a,o[3*e+1]=r,o[3*e+2]=s}),o};var F=new f["a"].Store({state:{loaded:!1,sort:"default",stuff:B,huePositions:null,defaultPositions:null,defaultColors:null,currentBucket:null,itemsTotal:0,loadedAtlas:0,atlases:{}},getters:{totalFromBuckets:e=>Object.values(e.stuff).map(e=>e.count).reduce((e,t)=>e+t,0)},actions:{getcurrentAtlases({dispatch:e,commit:t,state:n}){const a=n.currentBucket,r=n.currentBucket.ids,o=Math.ceil(r.length/_);t("setLoadedAtlas",o);for(let s=0;s<o;s++)e("getAtlasForBucketIndex",{bucket:a,index:s})},getAtlasForBucketIndex({commit:e},{bucket:t,index:n}){const a="/atlas/"+t.key+"_"+n+".jpg",r=new j;r.load(a,a=>{e("decreaseLoadedAtlas"),a.encoding=w["L"],e("setAtlasForBucketIndex",{bucket:t,index:n,atlas:a})})}},mutations:{setSort:(e,t)=>{t||(t="default"),e.sort=t},setLoadedAtlas:(e,t)=>{e.loadedAtlas=t},decreaseLoadedAtlas:e=>{e.loadedAtlas--},setAtlasForBucketIndex:(e,{bucket:t,index:n,atlas:a})=>{const r=Object.assign({},e.atlases),o=Object.assign({},r[t.key]);o[n]=a,r[t.key]=o,e.atlases=r},setStuff:(e,t)=>e.stuff=t,setBucket(e,t){return Object(p["a"])(this,void 0,void 0,(function*(){if(!t)return void(e.currentBucket=null);const n="/buckets/"+t.key+".txt",a=yield A.get(n),r=a.data,o=Object.assign(Object.assign({},e.stuff[t.id]),t);o.ids=r.split(",");const{pixels:s,width:i}=yield C(o);o.pixels=s;const{colors:c,positions:l,hsls:d}=N(o.pixels);e.defaultColors=c,e.defaultPositions=l,e.huePositions=D({hsls:d,width:i}),e.currentBucket=o}))},getIdsForBucket(e,t){return Object(p["a"])(this,void 0,void 0,(function*(){const n="http://127.0.0.1:9200/file_202027/_search",a=t.key,r=t.id,o=t.count,s=Math.ceil(o/x),i=new Array(s),c={track_total_hits:!0};let l=[];yield P(i,(e,o)=>Object(p["a"])(this,void 0,void 0,(function*(){let e=E().size(x).from(o*x).rawOption("_source","_id");e=L({key:a,id:r,query:e});const s=t.esQuery;s&&(e=T({query:e,esQuery:s}));const i=yield A.post(n,Object.assign(Object.assign({},e.build()),c)),d=i.data.hits;l=l.concat(d.hits.map(e=>e._id))})));const d=Object.assign(Object.assign({},t),{data:[...l]});let u=Object.assign({},e.stuff);u=Object.assign(Object.assign({},u),{[a]:d}),e.stuff=Object.assign({},u)}))},getBuckets(e){return Object(p["a"])(this,void 0,void 0,(function*(){const t="/counts.csv",n=yield A.get(t),a=yield v()().fromString(n.data),r={};let o=0;a.forEach(e=>{const t=e.bucket;if(!B[t])return;const n=Number(e.count),a=Object.assign(Object.assign({},B[t]),{count:n,key:t}),s=n<10?n:10;a.images=[];for(let r=0;r<s;r++)a.images.push("/images/"+t+"/"+r+".jpg");r[t]=a,o+=n}),e.stuff=r,e.itemsTotal=o,e.loaded=!0}))}},modules:{}});a["a"].config.productionTip=!1,new a["a"]({router:h,store:F,render:e=>e(l)}).$mount("#app")}});
//# sourceMappingURL=app.a2a157be.js.map